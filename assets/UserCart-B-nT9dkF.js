import{_ as P,p as S,m as k,r as y,o as i,c as d,a as c,b as t,F as w,i as C,h as m,d as x,v as L,e as u,t as r,f as h,g as T,w as M}from"./index-O4EEIHBO.js";import{S as v}from"./sweetalert2.all-EK7c56Sq.js";import{S as A,a as E,A as q,P as U,N}from"./navigation-BDfXkgLr.js";import{c as V}from"./cartStore-otakfmji.js";import{t as R}from"./toastMessage-Qj9VyzYM.js";var j={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"hedy-api-path",BASE_URL:"/Eco-Coffee/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:f,VITE_PATH:g}=j,D={data(){return{products:[],product:{},status:{loadingItem:""},isLoading:!1,coupon_code:""}},computed:{...S(V,["cart"])},methods:{...k(R,["pushMessage"]),...k(V,["getCart","addToCart"]),getProducts(){this.isLoading=!0;const e=`${f}/api/${g}/products/all`;this.axios.get(e).then(o=>{this.products=o.data.products,this.isLoading=!1}).catch(()=>{this.isLoading=!1})},updateCart(e){this.isLoading=!0;const o=`${f}/api/${g}/cart/${e.id}`,a={product_id:e.product_id,qty:e.qty};this.axios.put(o,{data:a}).then(_=>{this.pushMessage({style:"success",title:"更新購物車",content:_.data.message}),this.isLoading=!1,this.getCart()}).catch(_=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"更新購物車",content:_.response.data.message})})},getProduct(e){this.$router.push(`product/${e}`)},delCartItem(e){this.status.loadingItem=e;const o=`${f}/api/${g}/cart/${e}`;this.isLoading=!0,this.axios.delete(o).then(a=>{this.pushMessage({style:"success",title:"移除購物車品項",content:a.data.message}),this.status.loadingItem="",this.isLoading=!1,this.getCart()}).catch(a=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"移除購物車品項",content:a.response.data.message})})},delAllCarts(){this.isLoading=!0,v.fire({title:"確定清空購物車?",icon:"question",showCancelButton:!0,cancelButtonColor:"#6E7881",confirmButtonColor:"#198754",cancelButtonText:"取消",confirmButtonText:"確定",reverseButtons:!0}).then(e=>{if(e.isConfirmed){const o=`${f}/api/${g}/carts`;this.axios.delete(o).then(a=>{this.getCart(),this.isLoading=!1,v.fire({title:"清除購物車",content:a.data.message,icon:"success"})}).catch(a=>{this.isLoading=!1,v.fire({icon:"error",title:a.response.data.message})})}else this.isLoading=!1})},addCouponCode(){const e=`${f}/api/${g}/coupon`,o={code:this.coupon_code};this.isLoading=!0,this.axios.post(e,{data:o}).then(a=>{this.pushMessage({style:"success",title:"加入優惠券",content:a.data.message}),this.getCart(),this.isLoading=!1}).catch(a=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"加入優惠券",content:a.response.data.message})})}},mounted(){this.getCart(),this.getProducts()},components:{Swiper:A,SwiperSlide:E},setup(){return{modules:[q,U,N]}}},O={class:"container"},F={class:"mt-4"},H={key:0},z={class:"text-end"},X={class:"mt-3"},G=t("h3",{class:"mt-3 mb-4 text-primary fw-bold"},"購物車",-1),J={class:"row"},K={class:"col-md-8"},Q={class:"table"},W=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"border-0 ps-0"},"品名"),t("th",{scope:"col",class:"border-0"},"數量"),t("th",{scope:"col",class:"border-0",style:{"white-space":"nowrap"}}," 價格 "),t("th",{scope:"col",class:"border-0"})])],-1),Y={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},Z=["src"],tt={class:"d-inline-block ms-md-3 align-middle"},st={class:"mb-0 fw-bold d-inline-block"},et={key:0,class:"text-primary"},ot={class:"border-0 align-middle",style:{"max-width":"170px"}},at={class:"row g-0"},it={class:"d-flex flex-wrap"},dt={class:"col-10"},nt={class:"input-group"},rt=["onClick","disabled"],lt=["onClick"],ct=t("i",{class:"bi bi-trash3"},null,-1),ut=[ct],ht=["onUpdate:modelValue","disabled"],pt=["onClick"],_t={class:"border-0 align-middle",style:{"max-width":"160px"}},bt={class:"mb-0 ms-auto"},mt={key:0,class:"text-primary text-center"},ft=t("br",null,null,-1),gt={class:"border-0 align-middle"},yt=["onClick","disabled"],wt={key:0,class:"fas fa-spinner fa-pulse"},vt={class:"input-group w-50 mb-6 border-dark"},kt={class:"input-group-append"},Ct=t("i",{class:"bi bi-send-check-fill"},null,-1),xt=[Ct],Lt=t("i",{class:"bi bi-chevron-double-left mr-1"},null,-1),Vt={class:"col-md-4 mt-4"},Bt={class:"border p-4 mb-4 border-dark"},$t=t("p",{class:"h4 mb-4 text-primary fw-bold"},"訂單明細",-1),It={class:"table text-muted border-bottom border-dark"},Pt=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),St={class:"text-end border-0 px-0 pt-4"},Tt=t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"}," 支付方式 "),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),Mt={class:"d-flex justify-content-between mt-4"},At=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),Et={class:"mb-0 h4 fw-bold"},qt={key:0,class:"d-flex justify-content-between mt-4"},Ut=t("p",{class:"mb-0 h4 fw-bold text-primary"},"折扣價",-1),Nt={class:"mb-0 h4 fw-bold text-primary"},Rt={key:1,class:"text-center text-danger"},jt=t("p",null,"購物車無商品，快去逛逛",-1),Dt=t("i",{class:"bi bi-chevron-double-left mr-1"},null,-1),Ot={class:"container mt-5 ec-container"},Ft=t("h2",{class:"text-center fw-bold"},"熱銷商品",-1),Ht={class:"d-flex justify-content-center my-4"},zt={class:"row"},Xt={class:"col-md-4 col-sm"},Gt={class:"card swiper-card mb-sm-4 ms-md-4 m-sm-auto"},Jt=["src"],Kt={class:"card-body"},Qt={class:"badge rounded-pill bg-primary mb-2"},Wt={class:"card-title fs-6 fw-bold"},Yt={class:"card-text"},Zt=["onClick"],ts=t("i",{class:"bi bi-cart-check me-2"},null,-1);function ss(e,o,a,_,l,n){const B=y("LoadingOverLay"),b=y("router-link"),$=y("swiper-slide"),I=y("swiper");return i(),d(w,null,[c(B,{active:l.isLoading,"z-index":1060},null,8,["active"]),t("section",O,[t("div",F,[e.cart.carts&&e.cart.carts.length>0?(i(),d("div",H,[t("div",z,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:o[0]||(o[0]=(...s)=>n.delAllCarts&&n.delAllCarts(...s))}," 清空購物車 ")]),t("div",X,[G,t("div",J,[t("div",K,[t("table",Q,[W,t("tbody",null,[e.cart.carts?(i(!0),d(w,{key:0},C(e.cart.carts,s=>(i(),d("tr",{key:s.id,class:"border-bottom border-top border-dark"},[t("th",Y,[c(b,{to:`/product/${s.id}`},{default:u(()=>[t("img",{src:s.product.imageUrl,style:{width:"80px",height:"80px","object-fit":"cover"}},null,8,Z)]),_:2},1032,["to"]),t("div",tt,[t("p",st,r(s.product.title),1),s.coupon?(i(),d("div",et," 已套用優惠券 ")):m("",!0)])]),t("td",ot,[t("div",at,[t("div",it,[t("div",dt,[t("div",nt,[s.qty>1?(i(),d("button",{key:0,type:"button",class:"btn btn-primary text-white",onClick:p=>{s.qty--,n.updateCart(s)},disabled:s.qty===1}," - ",8,rt)):(i(),d("button",{key:1,type:"button",class:"btn btn-dark text-white",onClick:p=>n.delCartItem(s.id)},ut,8,lt)),x(t("input",{type:"number",class:"form-control border-dark text-center",min:"1","onUpdate:modelValue":p=>s.qty=p,disabled:l.status.loadingItem===s.id,readonly:""},null,8,ht),[[L,s.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary text-white",onClick:p=>{s.qty++,n.updateCart(s)}}," + ",8,pt)])])])])]),t("td",_t,[t("p",bt,[e.cart.final_total!==e.cart.total?(i(),d("small",mt,[h("優惠"),ft])):m("",!0),h(" "+r(e.$filters.currency(s.final_total)),1)])]),t("td",gt,[t("button",{type:"button",class:"btn btn-outline-dark",onClick:p=>n.delCartItem(s.id),disabled:l.status.loadingItem===s.id},[l.status.loadingItem===s.id?(i(),d("i",wt)):m("",!0),h(" X ")],8,yt)])]))),128)):m("",!0)])]),t("div",vt,[x(t("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=s=>l.coupon_code=s),class:"form-control rounded-0 border-bottom border-dark border-top-0 border-start-0 border-end-0 shadow-none",placeholder:"請輸入優惠碼","aria-label":"Recipient's username","aria-describedby":"button-addon2"},null,512),[[L,l.coupon_code]]),t("div",kt,[t("button",{class:"btn btn-outline-dark border-bottom border-dark border-top-0 border-start-0 border-end-0 rounded-0",type:"button",id:"button-addon2",onClick:o[2]||(o[2]=(...s)=>n.addCouponCode&&n.addCouponCode(...s))},xt)])]),c(b,{to:"/products",class:"text-primary fw-bold mb-5 h5"},{default:u(()=>[Lt,h(" 繼續購物 ")]),_:1})]),t("div",Vt,[t("div",Bt,[$t,t("table",It,[t("tbody",null,[t("tr",null,[Pt,t("td",St,r(e.$filters.currency(e.cart.total)),1)]),Tt])]),t("div",Mt,[At,t("p",Et,r(e.$filters.currency(e.cart.total)),1)]),e.cart.final_total!==e.cart.total?(i(),d("div",qt,[Ut,t("p",Nt,r(e.$filters.currency(e.cart.final_total)),1)])):m("",!0),c(b,{to:"/checkoutfirst",class:"btn btn-dark w-100 mt-4"},{default:u(()=>[h(" 確認訂單 ")]),_:1})])])])])])):(i(),d("div",Rt,[jt,c(b,{to:"/products",class:"text-dark mt-6 h5"},{default:u(()=>[Dt,h(" 前往購物 ")]),_:1})]))])]),t("section",Ot,[Ft,t("div",Ht,[c(I,{autoplay:!0,slidesPerView:1,spaceBetween:10,breakpoints:{375:{slidesPerView:1,spaceBetween:10},768:{slidesPerView:3,spaceBetween:30},1024:{slidesPerView:4,spaceBetween:30}},modules:_.modules,class:"mySwiper"},{default:u(()=>[(i(!0),d(w,null,C(l.products,s=>(i(),T($,{key:s.id},{default:u(()=>[t("div",zt,[t("div",Xt,[t("div",Gt,[c(b,{to:`/product/${s.id}`,class:"swiper-card-link"},{default:u(()=>[t("img",{src:s.imageUrl,class:"swiper-card-img"},null,8,Jt)]),_:2},1032,["to"]),t("div",Kt,[t("span",Qt,r(s.category),1),t("h5",Wt,r(s.title),1),t("p",Yt,"NT$ "+r(s.price),1),t("a",{class:"btn btn-primary d-flex justify-content-center text-white",onClick:M(p=>e.addToCart(s.id),["prevent"])},[ts,h("加入購物車")],8,Zt)])])])])]),_:2},1024))),128))]),_:1},8,["modules"])])])],64)}const ns=P(D,[["render",ss]]);export{ns as default};
