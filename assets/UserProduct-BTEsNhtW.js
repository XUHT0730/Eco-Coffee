import{_ as G,r as M,o as f,c as v,a as x,e as T,b as s,F as E,i as N,g as A,m as Q,t as g,h as D,f as P,w as R}from"./index-O4EEIHBO.js";import{S as F}from"./sweetalert2.all-EK7c56Sq.js";import{g as W,i as Z,e as $,n as U,b as j,N as J,S as X,a as Y,A as ee,P as te}from"./navigation-BDfXkgLr.js";import{c as se}from"./cartStore-otakfmji.js";function ie(l){let{swiper:e,extendParams:m,on:_}=l;m({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let o=!1,k=!1;e.thumbs={swiper:null};function S(){const i=e.thumbs.swiper;if(!i||i.destroyed)return;const t=i.clickedIndex,d=i.clickedSlide;if(d&&d.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof t>"u"||t===null)return;let r;i.params.loop?r=parseInt(i.clickedSlide.getAttribute("data-swiper-slide-index"),10):r=t,e.params.loop?e.slideToLoop(r):e.slideTo(r)}function b(){const{thumbs:i}=e.params;if(o)return!1;o=!0;const t=e.constructor;if(i.swiper instanceof t)e.thumbs.swiper=i.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update();else if(Z(i.swiper)){const d=Object.assign({},i.swiper);Object.assign(d,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new t(d),k=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",S),!0}function u(i){const t=e.thumbs.swiper;if(!t||t.destroyed)return;const d=t.params.slidesPerView==="auto"?t.slidesPerViewDynamic():t.params.slidesPerView;let r=1;const c=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(r=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(r=1),r=Math.floor(r),t.slides.forEach(h=>h.classList.remove(c)),t.params.loop||t.params.virtual&&t.params.virtual.enabled)for(let h=0;h<r;h+=1)$(t.slidesEl,`[data-swiper-slide-index="${e.realIndex+h}"]`).forEach(a=>{a.classList.add(c)});else for(let h=0;h<r;h+=1)t.slides[e.realIndex+h]&&t.slides[e.realIndex+h].classList.add(c);const p=e.params.thumbs.autoScrollOffset,L=p&&!t.params.loop;if(e.realIndex!==t.realIndex||L){const h=t.activeIndex;let a,C;if(t.params.loop){const n=t.slides.filter(I=>I.getAttribute("data-swiper-slide-index")===`${e.realIndex}`)[0];a=t.slides.indexOf(n),C=e.activeIndex>e.previousIndex?"next":"prev"}else a=e.realIndex,C=a>e.previousIndex?"next":"prev";L&&(a+=C==="next"?p:-1*p),t.visibleSlidesIndexes&&t.visibleSlidesIndexes.indexOf(a)<0&&(t.params.centeredSlides?a>h?a=a-Math.floor(d/2)+1:a=a+Math.floor(d/2)-1:a>h&&t.params.slidesPerGroup,t.slideTo(a,i?0:void 0))}}_("beforeInit",()=>{const{thumbs:i}=e.params;if(!(!i||!i.swiper))if(typeof i.swiper=="string"||i.swiper instanceof HTMLElement){const t=W(),d=()=>{const c=typeof i.swiper=="string"?t.querySelector(i.swiper):i.swiper;if(c&&c.swiper)i.swiper=c.swiper,b(),u(!0);else if(c){const p=L=>{i.swiper=L.detail[0],c.removeEventListener("init",p),b(),u(!0),i.swiper.update(),e.update()};c.addEventListener("init",p)}return c},r=()=>{if(e.destroyed)return;d()||requestAnimationFrame(r)};requestAnimationFrame(r)}else b(),u(!0)}),_("slideChange update resize observerUpdate",()=>{u()}),_("setTransition",(i,t)=>{const d=e.thumbs.swiper;!d||d.destroyed||d.setTransition(t)}),_("beforeDestroy",()=>{const i=e.thumbs.swiper;!i||i.destroyed||k&&i.destroy()}),Object.assign(e.thumbs,{init:b,update:u})}function oe(l){let{swiper:e,extendParams:m,emit:_,once:o}=l;m({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function k(){if(e.params.cssMode)return;const u=e.getTranslate();e.setTranslate(u),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function S(){if(e.params.cssMode)return;const{touchEventsData:u,touches:i}=e;u.velocities.length===0&&u.velocities.push({position:i[e.isHorizontal()?"startX":"startY"],time:u.touchStartTime}),u.velocities.push({position:i[e.isHorizontal()?"currentX":"currentY"],time:U()})}function b(u){let{currentPos:i}=u;if(e.params.cssMode)return;const{params:t,wrapperEl:d,rtlTranslate:r,snapGrid:c,touchEventsData:p}=e,h=U()-p.touchStartTime;if(i<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(i>-e.maxTranslate()){e.slides.length<c.length?e.slideTo(c.length-1):e.slideTo(e.slides.length-1);return}if(t.freeMode.momentum){if(p.velocities.length>1){const w=p.velocities.pop(),y=p.velocities.pop(),K=w.position-y.position,z=w.time-y.time;e.velocity=K/z,e.velocity/=2,Math.abs(e.velocity)<t.freeMode.minimumVelocity&&(e.velocity=0),(z>150||U()-w.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=t.freeMode.momentumVelocityRatio,p.velocities.length=0;let a=1e3*t.freeMode.momentumRatio;const C=e.velocity*a;let n=e.translate+C;r&&(n=-n);let I=!1,B;const V=Math.abs(e.velocity)*20*t.freeMode.momentumBounceRatio;let O;if(n<e.maxTranslate())t.freeMode.momentumBounce?(n+e.maxTranslate()<-V&&(n=e.maxTranslate()-V),B=e.maxTranslate(),I=!0,p.allowMomentumBounce=!0):n=e.maxTranslate(),t.loop&&t.centeredSlides&&(O=!0);else if(n>e.minTranslate())t.freeMode.momentumBounce?(n-e.minTranslate()>V&&(n=e.minTranslate()+V),B=e.minTranslate(),I=!0,p.allowMomentumBounce=!0):n=e.minTranslate(),t.loop&&t.centeredSlides&&(O=!0);else if(t.freeMode.sticky){let w;for(let y=0;y<c.length;y+=1)if(c[y]>-n){w=y;break}Math.abs(c[w]-n)<Math.abs(c[w-1]-n)||e.swipeDirection==="next"?n=c[w]:n=c[w-1],n=-n}if(O&&o("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(r?a=Math.abs((-n-e.translate)/e.velocity):a=Math.abs((n-e.translate)/e.velocity),t.freeMode.sticky){const w=Math.abs((r?-n:n)-e.translate),y=e.slidesSizesGrid[e.activeIndex];w<y?a=t.speed:w<2*y?a=t.speed*1.5:a=t.speed*2.5}}else if(t.freeMode.sticky){e.slideToClosest();return}t.freeMode.momentumBounce&&I?(e.updateProgress(B),e.setTransition(a),e.setTranslate(n),e.transitionStart(!0,e.swipeDirection),e.animating=!0,j(d,()=>{!e||e.destroyed||!p.allowMomentumBounce||(_("momentumBounce"),e.setTransition(t.speed),setTimeout(()=>{e.setTranslate(B),j(d,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(_("_freeModeNoMomentumRelease"),e.updateProgress(n),e.setTransition(a),e.setTranslate(n),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,j(d,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(n),e.updateActiveIndex(),e.updateSlidesClasses()}else if(t.freeMode.sticky){e.slideToClosest();return}else t.freeMode&&_("_freeModeNoMomentumRelease");(!t.freeMode.momentum||h>=t.longSwipesMs)&&(_("_freeModeStaticRelease"),e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:k,onTouchMove:S,onTouchEnd:b}})}const re={props:{product:Object},data(){return{thumbsSwiper:null,modules:[J,ie,oe]}},methods:{setThumbsSwiper(l){this.thumbsSwiper=l}},components:{Swiper:X,SwiperSlide:Y}},ne=["src","alt"],ae=["src","alt"],le=["src","alt"],ce=["src","alt"];function de(l,e,m,_,o,k){const S=M("SwiperSlide"),b=M("Swiper");return f(),v(E,null,[x(b,{loop:!1,spaceBetween:10,navigation:!1,thumbs:{swiper:o.thumbsSwiper},modules:o.modules,class:"mySwiper2"},{default:T(()=>[x(S,null,{default:T(()=>[s("img",{src:m.product.imageUrl,alt:m.product.title},null,8,ne)]),_:1}),(f(!0),v(E,null,N(m.product.imagesUrl,(u,i)=>(f(),A(S,{key:i},{default:T(()=>[s("img",{src:m.product.imagesUrl[i],alt:m.product.title},null,8,ae)]),_:2},1024))),128))]),_:1},8,["thumbs","modules"]),x(b,{onSwiper:k.setThumbsSwiper,loop:!1,spaceBetween:10,slidesPerView:6,freeMode:!0,watchSlidesVisibility:!0,watchSlidesProgress:!0,modules:o.modules,class:"mySwiper"},{default:T(()=>[x(S,null,{default:T(()=>[s("img",{src:m.product.imageUrl,alt:m.product.title},null,8,le)]),_:1}),(f(!0),v(E,null,N(m.product.imagesUrl,(u,i)=>(f(),A(S,{key:i},{default:T(()=>[s("img",{src:m.product.imagesUrl[i],alt:m.product.title,class:"object-fit-cover"},null,8,ce)]),_:2},1024))),128))]),_:1},8,["onSwiper","modules"])],64)}const ue=G(re,[["render",de],["__scopeId","data-v-c441184b"]]);var me={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"hedy-api-path",BASE_URL:"/Eco-Coffee/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:H,VITE_PATH:q}=me,pe={data(){return{isLoading:!1,thumbsSwiper:null,product:{},products:[],id:"",trackList:[]}},methods:{...Q(se,["addToCart"]),setThumbsSwiper(l){this.thumbsSwiper=l},getProducts(){const l=`${H}/api/${q}/products/all`;this.isLoading=!0,this.axios.get(l).then(e=>{this.products=e.data.products,this.isLoading=!1}).catch(e=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"取得產品資訊失敗",content:e.response.data.message})})},getProduct(){const l=`${H}/api/${q}/product/${this.id}`;this.isLoading=!0,this.axios.get(l).then(e=>{this.product=e.data.product,this.isLoading=!1}).catch(()=>{this.isLoading=!1})},getTrack(){const l=localStorage.getItem("homeTrack");l&&(this.trackList=JSON.parse(l))},setTrack(l){if(this.trackList.includes(l)){const e=this.trackList.findIndex(m=>m===l);this.trackList.splice(e,1),F.fire({icon:"success",title:"己移除收藏清單",showConfirmButton:!1,timer:1500})}else F.fire({icon:"success",title:"己加入收藏清單",showConfirmButton:!1,timer:1500}),this.trackList.push(l);localStorage.setItem("homeTrack",JSON.stringify(this.trackList)),this.getTrack()}},components:{Swiper:X,SwiperSlide:Y,SwiperComponent:ue},setup(){return{modules:[ee,te,J]}},created(){this.id=this.$route.params.productId,this.getProducts(),this.getProduct(),this.getTrack()}},he={class:"container"},fe={"aria-label":"breadcrumb"},_e={class:"breadcrumb mt-3"},be={class:"breadcrumb-item"},we={class:"breadcrumb-item"},ge={class:"breadcrumb-item active fw-bold","aria-current":"page"},ve={class:"row justify-content-center"},Te={class:"col-md-6 align-items-center"},Se=["src","alt"],ye={class:"col-md-5"},xe={class:"fw-bold mb-3"},ke={class:"badge bg-primary mb-2"},Me={class:"row d-flex flex-column"},Pe={class:"col"},Le={class:"fs-6"},Ce={class:"col"},Ie=s("p",{class:"fs-5 text-dark mt-2 mb-1"},"【 規格 】",-1),Ee={class:"text-muted"},Be={key:0,class:"h5"},Ve={key:1,class:"h6"},Ae={key:2,class:"h4 text-primary fw-bold"},Oe={class:"ms-3"},De=s("hr",null,null,-1),Re={class:"row my-4"},Ue={class:"col-6"},je={key:0},Ne=s("i",{class:"bi bi-heart-fill text-danger"},null,-1),ze=[Ne],Fe={key:1},He=s("i",{class:"bi bi-heart"},null,-1),qe=[He],Ge={class:"col-6"},Je=s("i",{class:"bi bi-cart-check"},null,-1),Xe={class:"container mt-6"},Ye=s("hr",null,null,-1),Ke=s("h2",{class:"text-center fw-bold my-5"},"熱銷商品",-1),Qe={class:"d-flex justify-content-center my-4"},We={class:"row"},Ze={class:"col-md-4 col-sm"},$e={class:"card swiper-card mb-sm-4 ms-md-4 m-sm-auto"},et=["src"],tt={class:"card-body"},st={class:"badge rounded-pill bg-primary mb-2"},it={class:"card-title fs-6 fw-bold"},ot={class:"card-text"},rt=["onClick"],nt=s("i",{class:"bi bi-cart-check me-2"},null,-1);function at(l,e,m,_,o,k){const S=M("LoadingOverLay"),b=M("RouterLink"),u=M("SwiperComponent"),i=M("router-link"),t=M("swiper-slide"),d=M("swiper");return f(),v(E,null,[x(S,{active:o.isLoading,"z-index":1060},null,8,["active"]),s("section",he,[s("nav",fe,[s("ol",_e,[s("li",be,[x(b,{to:"/home"},{default:T(()=>[P("首頁")]),_:1})]),s("li",we,[x(b,{to:"/products"},{default:T(()=>[P("全部商品")]),_:1})]),s("li",ge,g(o.product.title),1)])]),s("div",ve,[s("div",Te,[o.product.imagesUrl?(f(),A(u,{key:1,product:o.product},null,8,["product"])):(f(),v("img",{key:0,src:o.product.imageUrl,class:"img-fluid mb-3 object-fit-cover",width:"525",alt:o.product.title},null,8,Se))]),s("article",ye,[s("h2",xe,g(o.product.title),1),s("h5",null,[s("span",ke,g(o.product.category),1)]),s("div",Me,[s("div",Pe,[s("p",Le,g(o.product.description),1)]),s("div",Ce,[Ie,s("p",Ee,g(o.product.content),1)])]),o.product.price?D("",!0):(f(),v("div",Be,g(o.product.origin_price)+" 元 ",1)),o.product.price?(f(),v("del",Ve,"原價 "+g(o.product.origin_price)+" 元",1)):D("",!0),o.product.price?(f(),v("div",Ae,[P(" 現在只要 NT$ "+g(o.product.price)+" 元",1),s("span",Oe,"/ "+g(o.product.unit),1)])):D("",!0),De,s("div",Re,[s("div",Ue,[s("button",{class:"btn btn-outline-primary w-100",type:"button",onClick:e[0]||(e[0]=R(r=>k.setTrack(o.product.id),["prevent"]))},[o.trackList.includes(o.product.id)?(f(),v("span",je,ze)):(f(),v("span",Fe,qe)),P(" 加入收藏 ")])]),s("div",Ge,[s("button",{class:"btn btn-primary w-100",type:"button",onClick:e[1]||(e[1]=R(r=>l.addToCart(o.product.id),["prevent"]))},[Je,P(" 加入購物車 ")])])])])])]),s("section",Xe,[Ye,Ke,s("div",Qe,[x(d,{autoplay:!0,slidesPerView:1,spaceBetween:10,breakpoints:{375:{slidesPerView:1,spaceBetween:10},768:{slidesPerView:3,spaceBetween:30},1024:{slidesPerView:4,spaceBetween:30}},modules:_.modules,class:"mySwiper"},{default:T(()=>[(f(!0),v(E,null,N(o.products,r=>(f(),A(t,{key:r.id},{default:T(()=>[s("div",We,[s("div",Ze,[s("div",$e,[x(i,{to:`/product/${r.id}`,class:"swiper-card-link"},{default:T(()=>[s("img",{src:r.imageUrl,class:"swiper-card-img"},null,8,et)]),_:2},1032,["to"]),s("div",tt,[s("span",st,g(r.category),1),s("h5",it,g(r.title),1),s("p",ot,"NT$ "+g(r.price),1),s("a",{class:"btn btn-primary d-flex justify-content-center text-white",onClick:R(c=>l.addToCart(r.id),["prevent"])},[nt,P("加入購物車")],8,rt)])])])])]),_:2},1024))),128))]),_:1},8,["modules"])])])],64)}const mt=G(pe,[["render",at]]);export{mt as default};
