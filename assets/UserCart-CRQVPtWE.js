import{_ as S,p as T,m as k,r as y,o as i,c as d,a as c,b as t,F as w,i as C,h as b,d as x,v as L,e as l,t as r,f as u,g as I,w as M}from"./index-aaLPSl0K.js";import{S as v}from"./sweetalert2.all-D_P0A1B9.js";import{S as A,a as E,A as U,P as N,N as R}from"./navigation-BZV3fHMN.js";import{c as B}from"./cartStore-vWDUzHx-.js";import{t as j}from"./toastMessage-DNINzTwN.js";var D={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"hedy-api-path",BASE_URL:"/Eco-Coffee/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:m,VITE_PATH:g}=D,q={data(){return{products:[],product:{},status:{loadingItem:""},isLoading:!1,coupon_code:""}},computed:{...T(B,["cart"])},methods:{...k(j,["pushMessage"]),...k(B,["getCart","addToCart"]),getProducts(){this.isLoading=!0;const s=`${m}/api/${g}/products/all`;this.axios.get(s).then(o=>{this.products=o.data.products,this.isLoading=!1}).catch(o=>{this.isLoading=!1,alert(o.response.data.message)})},updateCart(s){this.isLoading=!0;const o=`${m}/api/${g}/cart/${s.id}`,a={product_id:s.product_id,qty:s.qty};this.axios.put(o,{data:a}).then(p=>{this.pushMessage({style:"success",title:"更新購物車",content:p.data.message}),this.isLoading=!1,this.getCart()}).catch(p=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"更新購物車",content:p.response.data.message})})},getProduct(s){this.$router.push(`product/${s}`)},delCartItem(s){this.status.loadingItem=s;const o=`${m}/api/${g}/cart/${s}`;this.isLoading=!0,this.axios.delete(o).then(a=>{this.pushMessage({style:"success",title:"移除購物車品項",content:a.data.message}),this.status.loadingItem="",this.isLoading=!1,this.getCart()}).catch(a=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"移除購物車品項",content:a.response.data.message})})},delAllCarts(){this.isLoading=!0,v.fire({title:"確定清空購物車?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確定",cancelButtonText:"取消"}).then(s=>{if(s.isConfirmed){const o=`${m}/api/${g}/carts`;this.axios.delete(o).then(a=>{this.getCart(),this.isLoading=!1,v.fire({title:"清除購物車",content:a.data.message,icon:"success"})}).catch(a=>{this.isLoading=!1,v.fire({icon:"error",title:a.response.data.message})})}else this.isLoading=!1})},addCouponCode(){const s=`${m}/api/${g}/coupon`,o={code:this.coupon_code};this.isLoading=!0,this.axios.post(s,{data:o}).then(a=>{this.pushMessage({style:"success",title:"加入優惠券",content:a.data.message}),this.getCart(),this.isLoading=!1}).catch(a=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"加入優惠券",content:a.response.data.message})})}},mounted(){this.getCart(),this.getProducts()},components:{Swiper:A,SwiperSlide:E},setup(){return{modules:[U,N,R]}}},O={class:"container"},F={class:"mt-4"},H={key:0},z={class:"text-end"},X={class:"mt-3"},G=t("h3",{class:"mt-3 mb-4 text-primary fw-bold"},"購物車",-1),J={class:"row"},K={class:"col-md-8"},Q={class:"table"},W=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"border-0 ps-0"},"品名"),t("th",{scope:"col",class:"border-0"},"數量"),t("th",{scope:"col",class:"border-0",style:{"white-space":"nowrap"}},"價格"),t("th",{scope:"col",class:"border-0"})])],-1),Y={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},Z=["src"],tt={class:"d-inline-block ms-md-3 align-middle"},st={class:"mb-0 fw-bold d-inline-block"},et={key:0,class:"text-primary"},ot={class:"border-0 align-middle",style:{"max-width":"170px"}},at={class:"row g-0"},it={class:"col"},dt={class:"input-group"},rt=["onUpdate:modelValue","onBlur","disabled"],nt={class:"col"},ct={class:"input-group"},lt={class:"input-group-text border-dark",id:"basic-addon2"},ut={class:"border-0 align-middle",style:{"max-width":"160px"}},ht={class:"mb-0 ms-auto"},pt={key:0,class:"text-primary text-center"},_t=t("br",null,null,-1),bt={class:"border-0 align-middle"},mt=["onClick","disabled"],gt={key:0,class:"fas fa-spinner fa-pulse"},ft={class:"input-group w-50 mb-6 border-dark"},yt={class:"input-group-append"},wt=t("i",{class:"bi bi-send-check-fill"},null,-1),vt=[wt],kt=t("i",{class:"bi bi-chevron-double-left mr-1"},null,-1),Ct={class:"col-md-4"},xt={class:"border p-4 mb-4 border-dark"},Lt=t("p",{class:"h4 mb-4 text-primary fw-bold"},"訂單明細",-1),Bt={class:"table text-muted border-bottom border-dark"},Vt=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"小計",-1),$t={class:"text-end border-0 px-0 pt-4"},Pt=t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"支付方式"),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),St={class:"d-flex justify-content-between mt-4"},Tt=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),It={class:"mb-0 h4 fw-bold"},Mt={key:0,class:"d-flex justify-content-between mt-4"},At=t("p",{class:"mb-0 h4 fw-bold text-primary"},"折扣價",-1),Et={class:"mb-0 h4 fw-bold text-primary"},Ut={key:1,class:"text-center text-danger"},Nt=t("p",null,"購物車無商品，快去逛逛",-1),Rt=t("i",{class:"bi bi-chevron-double-left mr-1"},null,-1),jt={class:"container mt-5 ec-container"},Dt=t("h2",{class:"text-center fw-bold"},"熱銷商品",-1),qt={class:"d-flex justify-content-center my-4"},Ot={class:"row"},Ft={class:"col-md-4 col-sm"},Ht={class:"card swiper-card mb-sm-4 ms-md-4 m-sm-auto"},zt=["src"],Xt={class:"card-body"},Gt={class:"badge rounded-pill bg-primary mb-2"},Jt={class:"card-title fs-6 fw-bold"},Kt={class:"card-text"},Qt=["onClick"],Wt=t("i",{class:"bi bi-cart-check me-2"},null,-1);function Yt(s,o,a,p,n,h){const V=y("LoadingOverLay"),_=y("router-link"),$=y("swiper-slide"),P=y("swiper");return i(),d(w,null,[c(V,{active:n.isLoading,"z-index":1060},null,8,["active"]),t("section",O,[t("div",F,[s.cart.carts&&s.cart.carts.length>0?(i(),d("div",H,[t("div",z,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:o[0]||(o[0]=(...e)=>h.delAllCarts&&h.delAllCarts(...e))}," 清空購物車 ")]),t("div",X,[G,t("div",J,[t("div",K,[t("table",Q,[W,t("tbody",null,[s.cart.carts?(i(!0),d(w,{key:0},C(s.cart.carts,e=>(i(),d("tr",{key:e.id,class:"border-bottom border-top border-dark"},[t("th",Y,[c(_,{to:`/product/${e.id}`},{default:l(()=>[t("img",{src:e.product.imageUrl,style:{width:"80px",height:"80px","object-fit":"cover"}},null,8,Z)]),_:2},1032,["to"]),t("div",tt,[t("p",st,r(e.product.title),1),e.coupon?(i(),d("div",et,"已套用優惠券")):b("",!0)])]),t("td",ot,[t("div",at,[t("div",it,[t("div",dt,[x(t("input",{type:"number",class:"form-control border-dark",min:"1","onUpdate:modelValue":f=>e.qty=f,onBlur:f=>h.updateCart(e),disabled:n.status.loadingItem===e.id},null,40,rt),[[L,e.qty,void 0,{number:!0}]])])]),t("div",nt,[t("div",ct,[t("span",lt,r(e.product.unit),1)])])])]),t("td",ut,[t("p",ht,[s.cart.final_total!==s.cart.total?(i(),d("small",pt,[u("優惠"),_t])):b("",!0),u(" "+r(s.$filters.currency(e.final_total)),1)])]),t("td",bt,[t("button",{type:"button",class:"btn btn-outline-dark",onClick:f=>h.delCartItem(e.id),disabled:n.status.loadingItem===e.id},[n.status.loadingItem===e.id?(i(),d("i",gt)):b("",!0),u(" X ")],8,mt)])]))),128)):b("",!0)])]),t("div",ft,[x(t("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>n.coupon_code=e),class:"form-control rounded-0 border-bottom border-dark border-top-0 border-start-0 border-end-0 shadow-none",placeholder:"請輸入優惠碼","aria-label":"Recipient's username","aria-describedby":"button-addon2"},null,512),[[L,n.coupon_code]]),t("div",yt,[t("button",{class:"btn btn-outline-dark border-bottom border-dark border-top-0 border-start-0 border-end-0 rounded-0",type:"button",id:"button-addon2",onClick:o[2]||(o[2]=(...e)=>h.addCouponCode&&h.addCouponCode(...e))},vt)])]),c(_,{to:"/products",class:"text-primary fw-bold mb-5 h5"},{default:l(()=>[kt,u(" 繼續購物 ")]),_:1})]),t("div",Ct,[t("div",xt,[Lt,t("table",Bt,[t("tbody",null,[t("tr",null,[Vt,t("td",$t,r(s.$filters.currency(s.cart.total)),1)]),Pt])]),t("div",St,[Tt,t("p",It,r(s.$filters.currency(s.cart.total)),1)]),s.cart.final_total!==s.cart.total?(i(),d("div",Mt,[At,t("p",Et,r(s.$filters.currency(s.cart.final_total)),1)])):b("",!0),c(_,{to:"/checkoutfirst",class:"btn btn-dark w-100 mt-4"},{default:l(()=>[u(" 確認訂單 ")]),_:1})])])])])])):(i(),d("div",Ut,[Nt,c(_,{to:"/products",class:"text-dark mt-6 h5"},{default:l(()=>[Rt,u(" 前往購物 ")]),_:1})]))])]),t("section",jt,[Dt,t("div",qt,[c(P,{autoplay:!0,slidesPerView:1,spaceBetween:10,breakpoints:{375:{slidesPerView:1,spaceBetween:10},768:{slidesPerView:3,spaceBetween:30},1024:{slidesPerView:4,spaceBetween:30}},modules:p.modules,class:"mySwiper"},{default:l(()=>[(i(!0),d(w,null,C(n.products,e=>(i(),I($,{key:e.id},{default:l(()=>[t("div",Ot,[t("div",Ft,[t("div",Ht,[c(_,{to:`/product/${e.id}`,class:"swiper-card-link"},{default:l(()=>[t("img",{src:e.imageUrl,class:"swiper-card-img"},null,8,zt)]),_:2},1032,["to"]),t("div",Xt,[t("span",Gt,r(e.category),1),t("h5",Jt,r(e.title),1),t("p",Kt,"NT$ "+r(e.price),1),t("a",{class:"btn btn-primary d-flex justify-content-center text-white",onClick:M(f=>s.addToCart(e.id),["prevent"])},[Wt,u("加入購物車")],8,Qt)])])])])]),_:2},1024))),128))]),_:1},8,["modules"])])])],64)}const as=S(q,[["render",Yt]]);export{as as default};
