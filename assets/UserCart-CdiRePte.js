import{_ as I,p as $,m as w,r as g,o as n,c as i,a as c,b as t,F as y,i as S,d as T,v as E,e as v,h as u,t as p,f as l}from"./index-CyFzxdHH.js";import{S as C}from"./sweetalert2.all-wwUo28J8.js";import{c as k}from"./cartStore-BuOky3c6.js";import{t as B}from"./toastMessage-8D0dX8LJ.js";import{S as M}from"./SwiperComponent2-B1dS7lz1.js";var V={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"hedy-api-path",BASE_URL:"/Eco-Coffee/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:h,VITE_PATH:b}=V,q={data(){return{products:[],product:{},status:{loadingItem:""},isLoading:!1,coupon_code:""}},computed:{...$(k,["cart"])},methods:{...w(B,["pushMessage"]),...w(k,["getCart","addToCart"]),getProducts(){this.isLoading=!0;const s=`${h}/api/${b}/products/all`;this.axios.get(s).then(o=>{this.products=o.data.products,this.isLoading=!1}).catch(()=>{this.isLoading=!1})},updateCart(s){this.isLoading=!0;const o=`${h}/api/${b}/cart/${s.id}`,a={product_id:s.product_id,qty:s.qty};this.axios.put(o,{data:a}).then(_=>{this.pushMessage({style:"success",title:"更新購物車",content:_.data.message}),this.isLoading=!1,this.getCart()}).catch(_=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"更新購物車",content:_.response.data.message})})},getProduct(s){this.$router.push(`product/${s}`)},delCartItem(s){this.status.loadingItem=s;const o=`${h}/api/${b}/cart/${s}`;this.isLoading=!0,this.axios.delete(o).then(a=>{this.pushMessage({style:"success",title:"移除購物車品項",content:a.data.message}),this.status.loadingItem="",this.isLoading=!1,this.getCart()}).catch(a=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"移除購物車品項",content:a.response.data.message})})},delAllCarts(){this.isLoading=!0,C.fire({title:"確定清空購物車?",icon:"question",showCancelButton:!0,cancelButtonColor:"#6E7881",confirmButtonColor:"#198754",cancelButtonText:"取消",confirmButtonText:"確定",reverseButtons:!0}).then(s=>{if(s.isConfirmed){const o=`${h}/api/${b}/carts`;this.axios.delete(o).then(a=>{this.getCart(),this.isLoading=!1,C.fire({title:"清除購物車",content:a.data.message,icon:"success"})}).catch(a=>{this.isLoading=!1,C.fire({icon:"error",title:a.response.data.message})})}else this.isLoading=!1})},addCouponCode(){const s=`${h}/api/${b}/coupon`,o={code:this.coupon_code};this.isLoading=!0,this.axios.post(s,{data:o}).then(a=>{this.pushMessage({style:"success",title:"加入優惠券",content:a.data.message}),this.getCart(),this.isLoading=!1}).catch(a=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"加入優惠券",content:a.response.data.message})})}},mounted(){this.getCart(),this.getProducts()},components:{SwiperComponent2:M}},A={class:"container"},P={class:"mt-4"},j={key:0},R={class:"text-end"},U={class:"row justify-content-center mt-4"},D={class:"col-md-6 bg-white mb-4 overflow-hidden"},N=t("div",{class:"d-flex justify-content-between"},[t("p",{class:"h2 text-primary fw-bold"},"購物車內容")],-1),O={class:"d-flex mt-4 bg-light align-items-center"},z=["src","alt"],F={class:"w-100 p-3 position-relative"},H=["onClick","disabled"],X={key:0,class:"fas fa-spinner fa-pulse"},G={class:"mb-2 fw-bold me-4"},J={key:0,class:"fw-bold text-primary",style:{"font-size":"16px"}},K={class:"d-flex justify-content-between align-items-center w-100 mt-4"},Q={class:"input-group w-50 align-items-center"},W={class:"input-group-prepend pe-1"},Y=["onClick","disabled"],Z=t("i",{class:"bi bi-dash-lg fs-4 text-primary fw-bold"},null,-1),tt=[Z],st=["onClick"],et=t("i",{class:"bi bi-trash3 fs-4 text-dark fw-bold"},null,-1),ot=[et],at=["value","disabled"],nt={class:"input-group-append ps-1"},it=["onClick"],rt=t("i",{class:"bi bi-plus-lg fs-4 text-primary fw-bold"},null,-1),dt=[rt],lt={class:"mb-0 ms-auto text-end"},ct={key:0,class:"text-primary"},ut=t("br",null,null,-1),pt={class:"input-group w-100 mb-5 mt-3 border-dark"},ht={class:"input-group-append"},bt=t("i",{class:"bi bi-send-check-fill"},null,-1),_t=[bt],ft=t("i",{class:"bi bi-chevron-double-left mr-1"},null,-1),mt={class:"col-md-4"},gt={class:"border p-4 mb-4 border-dark"},yt=t("p",{class:"h4 mb-4 text-primary fw-bold"},"訂單明細",-1),vt={class:"table text-muted border-bottom border-dark"},Ct=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),wt={class:"text-end border-0 px-0 pt-4"},kt=t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"}," 支付方式 "),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),xt={class:"d-flex justify-content-between mt-4"},Lt=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),It={class:"mb-0 h4 fw-bold"},$t={key:0,class:"d-flex justify-content-between mt-4"},St=t("p",{class:"mb-0 h4 fw-bold text-primary"},"折扣價",-1),Tt={class:"mb-0 h4 fw-bold text-primary"},Et={key:1,class:"text-center text-danger"},Bt=t("p",{class:"h3 fw-bold mb-3"},"購物車無商品，快去逛逛吧 ~",-1),Mt=t("i",{class:"bi bi-chevron-double-left mr-1"},null,-1);function Vt(s,o,a,_,d,r){const x=g("LoadingOverLay"),f=g("router-link"),L=g("SwiperComponent2");return n(),i(y,null,[c(x,{active:d.isLoading,"z-index":1060},null,8,["active"]),t("section",A,[t("div",P,[s.cart.carts&&s.cart.carts.length>0?(n(),i("div",j,[t("div",R,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:o[0]||(o[0]=(...e)=>r.delAllCarts&&r.delAllCarts(...e))}," 清空購物車 ")]),t("div",U,[t("div",D,[N,s.cart.carts?(n(),i(y,{key:0},[(n(!0),i(y,null,S(s.cart.carts,e=>(n(),i("div",{key:e.id},[t("div",O,[t("img",{src:e.product.imageUrl,alt:e.product.title,class:"object-fit-cover w-70",style:{"max-height":"150px"}},null,8,z),t("div",F,[t("button",{type:"button",class:"btn btn-outline-dark position-absolute fw-bold border-0",style:{top:"10px",right:"9px"},onClick:m=>r.delCartItem(e.id),disabled:d.status.loadingItem===e.id},[d.status.loadingItem===e.id?(n(),i("i",X)):u("",!0),l(" X ")],8,H),t("div",null,[t("p",G,p(e.product.title),1),e.coupon?(n(),i("div",J," 已套用優惠券 ")):u("",!0)]),t("div",K,[t("div",Q,[t("div",W,[e.qty>1?(n(),i("button",{key:0,type:"button",style:{"background-color":"transparent",border:"none"},onClick:m=>{e.qty--,r.updateCart(e)},disabled:e.qty===1},tt,8,Y)):(n(),i("button",{key:1,type:"button",style:{"background-color":"transparent",border:"none"},onClick:m=>r.delCartItem(e.id)},ot,8,st))]),t("input",{id:"qty",type:"number",class:"form-control border-0 text-center my-auto shadow-none bg-light px-0",value:e.qty,disabled:d.status.loadingItem===e.id,"aria-label":"Example text with button addon","aria-describedby":"button-addon1",readonly:""},null,8,at),t("div",nt,[t("button",{type:"button",style:{"background-color":"transparent",border:"none"},onClick:m=>{e.qty++,r.updateCart(e)}},dt,8,it)])]),t("p",lt,[s.cart.final_total!==s.cart.total?(n(),i("small",ct,[l("優惠價"),ut])):u("",!0),l(" NT$ "+p(s.$filters.currency(e.final_total)),1)])])])])]))),128)),t("div",pt,[T(t("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>d.coupon_code=e),class:"form-control rounded-0 border-bottom border-dark border-top-0 border-start-0 border-end-0 shadow-none fs-7",placeholder:"請輸入優惠碼","aria-label":"Recipient's username","aria-describedby":"button-addon2"},null,512),[[E,d.coupon_code]]),t("div",ht,[t("button",{class:"btn btn-outline-dark border-bottom border-dark border-top-0 border-start-0 border-end-0 rounded-0 fs-5",type:"button",id:"button-addon2",onClick:o[2]||(o[2]=(...e)=>r.addCouponCode&&r.addCouponCode(...e))},_t)])]),c(f,{to:"/products",class:"text-primary fw-bold mb-5 h4"},{default:v(()=>[ft,l(" 繼續購物 ")]),_:1})],64)):u("",!0)]),t("div",mt,[t("div",gt,[yt,t("table",vt,[t("tbody",null,[t("tr",null,[Ct,t("td",wt,p(s.$filters.currency(s.cart.total)),1)]),kt])]),t("div",xt,[Lt,t("p",It,p(s.$filters.currency(s.cart.total)),1)]),s.cart.final_total!==s.cart.total?(n(),i("div",$t,[St,t("p",Tt,p(s.$filters.currency(s.cart.final_total)),1)])):u("",!0),c(f,{to:"/checkoutfirst",class:"btn btn-dark w-100 mt-4"},{default:v(()=>[l(" 確認訂單 ")]),_:1})])])])])):(n(),i("div",Et,[Bt,c(f,{to:"/products",class:"text-dark h3"},{default:v(()=>[Mt,l(" 前往購物 ")]),_:1})]))])]),c(L)],64)}const Ut=I(q,[["render",Vt]]);export{Ut as default};
