import{_ as S,p as T,m as w,r as g,o as n,c as i,a as u,b as t,F as y,i as V,d as k,v as x,e as v,h as p,t as h,f as l}from"./index-ScBNamNi.js";import{S as C}from"./sweetalert2.all-DYvzZ1P1.js";import{c as L}from"./cartStore-CNg7mac8.js";import{t as E}from"./toastMessage-C11o2i5Q.js";import{S as B}from"./SwiperComponent2-DFqBL4uK.js";var M={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"hedy-api-path",BASE_URL:"/Eco-Coffee/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:b,VITE_PATH:_}=M,q={data(){return{products:[],product:{},status:{loadingItem:""},isLoading:!1,coupon_code:""}},computed:{...T(L,["cart"])},methods:{...w(E,["pushMessage"]),...w(L,["getCart","addToCart"]),getProducts(){this.isLoading=!0;const e=`${b}/api/${_}/products/all`;this.axios.get(e).then(o=>{this.products=o.data.products,this.isLoading=!1}).catch(()=>{this.isLoading=!1})},updateCart(e){this.isLoading=!0;const o=`${b}/api/${_}/cart/${e.id}`,a={product_id:e.product_id,qty:e.qty};this.axios.put(o,{data:a}).then(m=>{this.pushMessage({style:"success",title:"更新購物車",content:m.data.message}),this.isLoading=!1,this.getCart()}).catch(m=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"更新購物車",content:m.response.data.message})})},getProduct(e){this.$router.push(`product/${e}`)},delCartItem(e){this.status.loadingItem=e;const o=`${b}/api/${_}/cart/${e}`;this.isLoading=!0,this.axios.delete(o).then(a=>{this.pushMessage({style:"success",title:"移除購物車品項",content:a.data.message}),this.status.loadingItem="",this.isLoading=!1,this.getCart()}).catch(a=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"移除購物車品項",content:a.response.data.message})})},delAllCarts(){this.isLoading=!0,C.fire({title:"確定清空購物車?",icon:"question",showCancelButton:!0,cancelButtonColor:"#6E7881",confirmButtonColor:"#198754",cancelButtonText:"取消",confirmButtonText:"確定",reverseButtons:!0}).then(e=>{if(e.isConfirmed){const o=`${b}/api/${_}/carts`;this.axios.delete(o).then(a=>{this.getCart(),this.isLoading=!1,C.fire({title:"清除購物車",content:a.data.message,icon:"success"})}).catch(a=>{this.isLoading=!1,C.fire({icon:"error",title:a.response.data.message})})}else this.isLoading=!1})},addCouponCode(){const e=`${b}/api/${_}/coupon`,o={code:this.coupon_code};this.isLoading=!0,this.axios.post(e,{data:o}).then(a=>{this.pushMessage({style:"success",title:"加入優惠券",content:a.data.message}),this.getCart(),this.isLoading=!1}).catch(a=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"加入優惠券",content:a.response.data.message})})}},mounted(){this.getCart(),this.getProducts()},components:{SwiperComponent2:B}},A={class:"container"},U={class:"mt-4"},P={key:0},j={class:"text-end"},R={class:"row justify-content-center mt-4"},D={class:"col-md-6 bg-white mb-4 overflow-hidden",style:{"min-height":"calc(100vh - 56px - 76px)"}},N=t("div",{class:"d-flex justify-content-between"},[t("p",{class:"h2 text-primary fw-bold"},"購物車內容")],-1),O={class:"d-flex mt-4 bg-light align-items-center"},z=["src","alt"],F={class:"w-100 p-3 position-relative"},H=["onClick","disabled"],X={key:0,class:"fas fa-spinner fa-pulse"},G={class:"mb-2 fw-bold me-4"},J={key:0,class:"fw-bold text-primary",style:{"font-size":"16px"}},K={class:"d-flex justify-content-between align-items-center w-100 mt-4"},Q={class:"input-group w-50 align-items-center"},W={class:"input-group-prepend pe-1"},Y=["onClick","disabled"],Z=t("i",{class:"bi bi-dash-lg fs-4 text-primary fw-bold"},null,-1),tt=[Z],et=["onClick"],st=t("i",{class:"bi bi-trash3 fs-4 text-dark fw-bold"},null,-1),ot=[st],at=["onUpdate:modelValue","disabled"],nt={class:"input-group-append ps-1"},it=["onClick"],rt=t("i",{class:"bi bi-plus-lg fs-4 text-primary fw-bold"},null,-1),dt=[rt],lt={class:"mb-0 ms-auto text-end"},ct={key:0,class:"text-primary"},ut=t("br",null,null,-1),pt={class:"input-group w-50 mb-5 mt-3 border-dark"},ht={class:"input-group-append"},bt=t("i",{class:"bi bi-send-check-fill"},null,-1),_t=[bt],mt=t("i",{class:"bi bi-chevron-double-left mr-1"},null,-1),ft={class:"col-md-4"},gt={class:"border p-4 mb-4 border-dark"},yt=t("p",{class:"h4 mb-4 text-primary fw-bold"},"訂單明細",-1),vt={class:"table text-muted border-bottom border-dark"},Ct=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"}," 小計 ",-1),wt={class:"text-end border-0 px-0 pt-4"},kt=t("tr",null,[t("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"}," 支付方式 "),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1),xt={class:"d-flex justify-content-between mt-4"},Lt=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1),It={class:"mb-0 h4 fw-bold"},$t={key:0,class:"d-flex justify-content-between mt-4"},St=t("p",{class:"mb-0 h4 fw-bold text-primary"},"折扣價",-1),Tt={class:"mb-0 h4 fw-bold text-primary"},Vt={key:1,class:"text-center text-danger"},Et=t("p",{class:"h3 fw-bold mb-3"},"購物車無商品，快去逛逛吧 ~ ",-1),Bt=t("i",{class:"bi bi-chevron-double-left mr-1"},null,-1);function Mt(e,o,a,m,d,r){const I=g("LoadingOverLay"),f=g("router-link"),$=g("SwiperComponent2");return n(),i(y,null,[u(I,{active:d.isLoading,"z-index":1060},null,8,["active"]),t("section",A,[t("div",U,[e.cart.carts&&e.cart.carts.length>0?(n(),i("div",P,[t("div",j,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:o[0]||(o[0]=(...s)=>r.delAllCarts&&r.delAllCarts(...s))}," 清空購物車 ")]),t("div",R,[t("div",D,[N,e.cart.carts?(n(),i(y,{key:0},[(n(!0),i(y,null,V(e.cart.carts,s=>(n(),i("div",{key:s.id},[t("div",O,[t("img",{src:s.product.imageUrl,alt:s.product.title,class:"object-fit-cover w-70",style:{"max-height":"150px"}},null,8,z),t("div",F,[t("button",{type:"button",class:"btn btn-outline-dark position-absolute fw-bold border-0",style:{top:"16px",right:"15px"},onClick:c=>r.delCartItem(s.id),disabled:d.status.loadingItem===s.id},[d.status.loadingItem===s.id?(n(),i("i",X)):p("",!0),l(" X ")],8,H),t("div",null,[t("p",G,h(s.product.title),1),s.coupon?(n(),i("div",J," 已套用優惠券 ")):p("",!0)]),t("div",K,[t("div",Q,[t("div",W,[s.qty>1?(n(),i("button",{key:0,type:"button",style:{"background-color":"transparent",border:"none"},onClick:c=>{s.qty--,r.updateCart(s)},disabled:s.qty===1},tt,8,Y)):(n(),i("button",{key:1,type:"button",style:{"background-color":"transparent",border:"none"},onClick:c=>r.delCartItem(s.id)},ot,8,et))]),k(t("input",{type:"number",class:"form-control border-0 text-center my-auto shadow-none bg-light px-0",min:"1","onUpdate:modelValue":c=>s.qty=c,disabled:d.status.loadingItem===s.id,"aria-label":"Example text with button addon","aria-describedby":"button-addon1",readonly:""},null,8,at),[[x,s.qty,void 0,{number:!0}]]),t("div",nt,[t("button",{type:"button",style:{"background-color":"transparent",border:"none"},onClick:c=>{s.qty++,r.updateCart(s)}},dt,8,it)])]),t("p",lt,[e.cart.final_total!==e.cart.total?(n(),i("small",ct,[l("優惠價"),ut])):p("",!0),l(" NT$ "+h(e.$filters.currency(s.final_total)),1)])])])])]))),128)),t("div",pt,[k(t("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=s=>d.coupon_code=s),class:"form-control rounded-0 border-bottom border-dark border-top-0 border-start-0 border-end-0 shadow-none fs-5",placeholder:"請輸入優惠碼","aria-label":"Recipient's username","aria-describedby":"button-addon2"},null,512),[[x,d.coupon_code]]),t("div",ht,[t("button",{class:"btn btn-outline-dark border-bottom border-dark border-top-0 border-start-0 border-end-0 rounded-0 fs-5",type:"button",id:"button-addon2",onClick:o[2]||(o[2]=(...s)=>r.addCouponCode&&r.addCouponCode(...s))},_t)])]),u(f,{to:"/products",class:"text-primary fw-bold mb-5 h5"},{default:v(()=>[mt,l(" 繼續購物 ")]),_:1})],64)):p("",!0)]),t("div",ft,[t("div",gt,[yt,t("table",vt,[t("tbody",null,[t("tr",null,[Ct,t("td",wt,h(e.$filters.currency(e.cart.total)),1)]),kt])]),t("div",xt,[Lt,t("p",It,h(e.$filters.currency(e.cart.total)),1)]),e.cart.final_total!==e.cart.total?(n(),i("div",$t,[St,t("p",Tt,h(e.$filters.currency(e.cart.final_total)),1)])):p("",!0),u(f,{to:"/checkoutfirst",class:"btn btn-dark w-100 mt-4"},{default:v(()=>[l(" 確認訂單 ")]),_:1})])])])])):(n(),i("div",Vt,[Et,u(f,{to:"/products",class:"text-dark h3"},{default:v(()=>[Bt,l(" 前往購物 ")]),_:1})]))])]),u($)],64)}const Rt=S(q,[["render",Mt]]);export{Rt as default};
